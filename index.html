<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hive AI - Calculadora de ROI</title>
    <!-- Tailwind CSS para el diseño -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React y ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel para compilar JSX en el navegador -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        input[type=range] { cursor: pointer; }
        .chart-container { position: relative; height: 300px; width: 100%; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            // --- Estado Humanos ---
            const [numAgents, setNumAgents] = useState(10);
            const [avgSalary, setAvgSalary] = useState(1200);
            const [trainingCost, setTrainingCost] = useState(500);
            const [attritionRate, setAttritionRate] = useState(15);
            const [physicalInfrCost, setPhysicalInfrCost] = useState(150);
            const [callsPerAgentDay, setCallsPerAgentDay] = useState(40);
            const [avgCallDuration, setAvgCallDuration] = useState(5);

            // --- Estado Hive AI ---
            const [aiCostPerHour, setAiCostPerHour] = useState(9.00); 
            const [implementationFee, setImplementationFee] = useState(2500);

            const [results, setResults] = useState({
                humanMonthlyCost: 0,
                aiMonthlyCost: 0,
                savingsYear1: 0,
                paybackMonths: 0,
                costPerCallHuman: 0,
                costPerCallAi: 0,
                attritionImpact: 0,
                infrImpact: 0
            });

            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            useEffect(() => {
                // Cálculos
                const monthlySalaryTotal = numAgents * avgSalary;
                const monthlyInfrTotal = numAgents * physicalInfrCost;
                const monthlyAttritionCost = (numAgents * (attritionRate / 100) * trainingCost) / 12;
                const totalHumanMonthly = monthlySalaryTotal + monthlyInfrTotal + monthlyAttritionCost;

                const totalMonthlyCalls = numAgents * callsPerAgentDay * 22;
                const totalHoursPerMonth = (totalMonthlyCalls * avgCallDuration) / 60;
                const totalAiMonthly = totalHoursPerMonth * aiCostPerHour;

                const savingsYear1 = (totalHumanMonthly * 12) - ((totalAiMonthly * 12) + implementationFee);
                const monthlySavings = totalHumanMonthly - totalAiMonthly;
                const payback = monthlySavings > 0 ? implementationFee / monthlySavings : 0;

                setResults({
                    humanMonthlyCost: totalHumanMonthly,
                    aiMonthlyCost: totalAiMonthly,
                    savingsYear1: savingsYear1,
                    paybackMonths: payback,
                    costPerCallHuman: totalMonthlyCalls > 0 ? totalHumanMonthly / totalMonthlyCalls : 0,
                    costPerCallAi: totalMonthlyCalls > 0 ? totalAiMonthly / totalMonthlyCalls : 0,
                    attritionImpact: monthlyAttritionCost,
                    infrImpact: monthlyInfrTotal
                });

                // Actualizar Gráfico
                if (chartInstance.current) chartInstance.current.destroy();
                const ctx = document.getElementById('roiChart').getContext('2d');
                chartInstance.current = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Operación Humana', 'Hive AI'],
                        datasets: [{
                            label: 'Costo Mensual ($)',
                            data: [totalHumanMonthly, totalAiMonthly],
                            backgroundColor: ['#94a3b8', '#4f46e5'],
                            borderRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } }
                    }
                });

                // Inicializar iconos de Lucide
                lucide.createIcons();
            }, [numAgents, avgSalary, trainingCost, attritionRate, physicalInfrCost, callsPerAgentDay, avgCallDuration, aiCostPerHour, implementationFee]);

            const formatCurrency = (val) => new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'USD' }).format(val);

            return (
                <div className="min-h-screen p-4 md:p-8">
                    <div className="max-w-6xl mx-auto">
                        <header className="mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4">
                            <div>
                                <h1 className="text-3xl font-bold text-indigo-900 flex items-center gap-2">
                                    <i data-lucide="calculator" className="text-indigo-600"></i>
                                    ROI: Humano vs. Hive AI
                                </h1>
                                <p className="text-slate-500 mt-2">Simulador de costos para el reemplazo de agentes por voces clonadas.</p>
                            </div>
                            <div className="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                <span className="text-xs font-semibold uppercase text-slate-400 block mb-1">Ahorro Estimado Año 1</span>
                                <span className="text-2xl font-bold text-emerald-600">{formatCurrency(results.savingsYear1)}</span>
                            </div>
                        </header>

                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            <div className="lg:col-span-1 space-y-6">
                                <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                                    <h2 className="text-lg font-semibold mb-4 flex items-center gap-2 text-indigo-800">
                                        <i data-lucide="users" size="20"></i> Costos Humanos
                                    </h2>
                                    <div className="space-y-4">
                                        <InputRange label="Agentes" value={numAgents} onChange={setNumAgents} min={1} max={100} unit="pax" />
                                        <InputRange label="Salario + Carga" value={avgSalary} onChange={setAvgSalary} min={500} max={5000} step={50} unit="$" />
                                        <InputRange label="Infraestructura" value={physicalInfrCost} onChange={setPhysicalInfrCost} min={0} max={1000} step={10} unit="$" />
                                        <InputRange label="Rotación Anual %" value={attritionRate} onChange={setAttritionRate} min={0} max={100} unit="%" />
                                    </div>
                                </div>

                                <div className="bg-white p-6 rounded-2xl shadow-sm border border-indigo-200 border-l-4 border-l-indigo-500">
                                    <h2 className="text-lg font-semibold mb-4 flex items-center gap-2 text-indigo-800">
                                        <i data-lucide="trending-up" size="20"></i> Costos Hive AI
                                    </h2>
                                    <div className="space-y-4">
                                        <InputRange label="Costo por Hora" value={aiCostPerHour} onChange={setAiCostPerHour} min={1} max={50} step={0.5} unit="$" />
                                        <InputRange label="Implementación" value={implementationFee} onChange={setImplementationFee} min={0} max={10000} step={500} unit="$" />
                                    </div>
                                </div>
                            </div>

                            <div className="lg:col-span-2 space-y-6">
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <MetricCard title="Costo/Llamada Humano" value={formatCurrency(results.costPerCallHuman)} color="text-red-500" />
                                    <MetricCard title="Costo/Llamada IA" value={formatCurrency(results.costPerCallAi)} color="text-emerald-500" highlight />
                                    <MetricCard title="Payback" value={`${results.paybackMonths.toFixed(1)} meses`} color="text-indigo-500" />
                                </div>

                                <div className="bg-white p-8 rounded-2xl shadow-sm border border-slate-200">
                                    <h3 className="text-xl font-bold mb-6">Comparativa de Costo Mensual</h3>
                                    <div className="chart-container">
                                        <canvas id="roiChart"></canvas>
                                    </div>
                                    <div className="mt-8 grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div className="p-4 bg-slate-50 rounded-xl border border-slate-100">
                                            <p className="text-xs font-bold text-slate-400 uppercase">Ahorro en Infraestructura</p>
                                            <p className="text-lg font-bold text-slate-700">{formatCurrency(results.infrImpact)} /mes</p>
                                        </div>
                                        <div className="p-4 bg-slate-50 rounded-xl border border-slate-100">
                                            <p className="text-xs font-bold text-slate-400 uppercase">Ahorro en Reclutamiento</p>
                                            <p className="text-lg font-bold text-slate-700">{formatCurrency(results.attritionImpact)} /mes</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const InputRange = ({ label, value, onChange, min, max, unit, step = 1 }) => (
            <div className="space-y-2">
                <div className="flex justify-between text-xs font-bold text-slate-500 uppercase">
                    <span>{label}</span>
                    <span className="text-indigo-600">{value} {unit}</span>
                </div>
                <input 
                    type="range" min={min} max={max} step={step} value={value} 
                    onChange={(e) => onChange(parseFloat(e.target.value))}
                    className="w-full h-1.5 bg-slate-200 rounded-lg appearance-none accent-indigo-600"
                />
            </div>
        );

        const MetricCard = ({ title, value, color, highlight = false }) => (
            <div className={`p-5 rounded-2xl border ${highlight ? 'bg-indigo-50 border-indigo-200 ring-2 ring-indigo-100' : 'bg-white border-slate-200'}`}>
                <h4 className="text-xs font-semibold text-slate-500 uppercase">{title}</h4>
                <p className={`text-xl font-bold ${color}`}>{value}</p>
            </div>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
